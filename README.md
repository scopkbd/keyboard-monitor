# キーボードモニター

> キーボード入力パターンを分析して、あなたのタイピング習慣を可視化するPythonツール

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Python](https://img.shields.io/badge/python-3.8+-green.svg)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey.svg)

## 概要

キーボードモニターは、あなたのキーボード使用パターンを記録・分析する軽量なPythonアプリケーションです。タイピングの癖を理解し、効率的なキーボードレイアウトの設計やタイピングスキルの向上に役立ちます。

### 主な機能

🔍 **リアルタイム監視**: すべてのキー入力をバックグラウンドで記録
📊 **詳細分析**: キー使用頻度、組み合わせパターン、連続入力の統計
⌨️ **モディファイア対応**: Ctrl/Shift/Alt/Win組み合わせの詳細追跡
🎯 **シーケンス分析**: よく使う文字列パターンの特定
💾 **ローカル保存**: すべてのデータは安全にローカルに保存

## インストール

### 前提条件

- Python 3.8以上
- Windows 10/11
- 管理者権限（初回実行時）

### セットアップ手順

1. **リポジトリのクローン**

   ```bash
   git clone https://github.com/your-username/keyboard-monitor.git
   cd keyboard-monitor
   ```

2. **依存関係のインストール**

   ```bash
   pip install -r requirements.txt
   ```

3. **初回設定**

   ```bash
   python src/keyboard_monitor.py --setup
   ```

## 使用方法

### 🎯 改善されたユーザーインターフェース

**v1.0での主要改善点:**
- ✅ **リアルタイム表示とコマンド入力の統合**: 入力中は表示更新が自動停止
- ✅ **スムーズなコマンド処理**: `q`、`t`などの短いコマンドも確実に動作
- ✅ **画面ちらつき防止**: カーソル位置制御による効率的な表示更新
- ✅ **直感的な操作感**: 自然で中断されないタイピング体験

### 基本的な使い方

#### 1. インタラクティブモードでの起動

```bash
python src/keyboard_monitor.py --cli
```

アプリケーションが起動すると、以下のような画面が表示されます：

```text
====================================
   キーボードモニター v1.0
====================================

状態: [停止中] | 最終記録: なし
コマンド: start, stop, stats, quit

> _
```

#### 2. 基本コマンド

| コマンド | 短縮形 | 説明 |
|----------|--------|------|
| `start` | `s` | キーボード記録開始 |
| `stop` | `t` | キーボード記録停止 |
| `stats` | `stat` | 統計情報表示 |
| `status` | `st` | 現在の状況確認 |
| `quit` | `q` | アプリケーション終了 |

#### 3. 統計情報の確認

記録を開始後、`stats`コマンドで詳細な分析結果を確認できます：

```text
> stats

====================================
   キーボード使用統計
====================================

記録期間: 2025-06-01 ～ 2025-06-10 (10日間)
総キーストローク: 25,678 回

トップ10キー:
  1. Space     : 3,456 回 (13.5%) ████████████████
  2. E         : 2,890 回 (11.3%) ████████████████
  3. T         : 2,345 回 ( 9.1%) ████████████
  ...

頻出シーケンス（Bigram）:
  1. TH : 456 回
  2. HE : 423 回
  3. ER : 398 回
```

### コマンドライン操作

統計情報の確認は、アプリケーションを起動せずに直接実行することも可能です：

```bash
# 全期間の統計表示
python src/keyboard_monitor.py --stats

# 特定日の統計表示
python src/keyboard_monitor.py --stats 2025-06-01

# システム状況確認
python src/keyboard_monitor.py --status
```

## 分析機能

### 基本統計

- **キー使用頻度**: 各キーの押下回数と割合
- **総キーストローク数**: 記録期間中の総入力数
- **使用パターン**: 時間帯別の入力傾向

### 高度な分析

- **モディファイア組み合わせ**: Ctrl/Shift/Alt/Winとの組み合わせパターン
- **キーシーケンス分析**: 2文字・3文字の連続入力パターン
- **前後関係分析**: 特定のキーの前に押されやすいキーの分析

### データ構造

記録されるデータは以下の形式でJSONファイルに保存されます：

```json
{
  "total_statistics": {
    "total_keystrokes": 25000,
    "first_record_date": "2025-06-01",
    "last_record_date": "2025-06-10"
  },
  "key_statistics": {
    "65": {
      "key_name": "A",
      "count": 850,
      "modifier_combinations": {
        "none": {"count": 750},
        "ctrl": {"count": 60},
        "shift": {"count": 40}
      }
    }
  }
}
```

## セキュリティとプライバシー

### データの扱い

- ✅ **完全ローカル**: すべてのデータはあなたのコンピューター内にのみ保存
- ✅ **ネットワーク送信なし**: インターネット接続は不要
- ✅ **個人利用限定**: 他人のコンピューターでの使用は禁止

### 注意事項

- パスワード入力時など、機密情報を扱う際は記録を一時停止することを推奨
- 共有コンピューターでの使用は避けてください
- データファイルは第三者がアクセスできない場所に保存されます

## トラブルシューティング

### よくある問題

#### 権限エラー

```text
エラー: キーボードアクセス権限が不足しています。
```

**解決方法**: 管理者権限でコマンドプロンプトを開き、再度実行してください。

#### ライブラリエラー

```text
エラー: 必要なライブラリが見つかりません。
```

**解決方法**:
```bash
pip install -r requirements.txt
```

#### データファイルエラー

```text
エラー: データファイルにアクセスできません。
```

**解決方法**: `data/`ディレクトリの権限を確認し、必要に応じて再作成してください。

### ログファイル

問題の詳細は以下のログファイルで確認できます：

- `logs/keyboard_monitor.log`: 一般的な動作ログ
- `logs/error.log`: エラー詳細ログ

## 開発情報

### プロジェクト構成

```text
keyboard-monitor/
├── src/                      # ソースコード
│   ├── keyboard_monitor.py   # メインアプリケーション
│   ├── logger.py            # キーロガー
│   ├── statistics.py        # 統計分析
│   └── config.py            # 設定管理
├── data/                    # データファイル
├── tests/                   # テストファイル
├── doc/                     # ドキュメント
│   ├── SPECIFICATIONS.md    # 技術仕様書
│   ├── ARCHITECTURE.md      # アーキテクチャ設計
│   └── CLI_INTERFACE.md     # CLI仕様
├── requirements.txt         # 依存関係
└── README.md               # このファイル
```

### 技術仕様

詳細な技術情報は以下のドキュメントを参照してください：

- 📋 [技術仕様書](doc/SPECIFICATIONS.md): データ構造とAPIの詳細
- 🏗️ [アーキテクチャ設計](doc/ARCHITECTURE.md): システム設計とコンポーネント構成
- 💻 [CLI仕様](doc/CLI_INTERFACE.md): コマンドラインインターフェースの詳細

### テスト

包括的なテストスイートが用意されています：

- 🧪 [テスト実行ガイド](tests/README.md): クイックスタートと概要
- 📖 [詳細テストガイド](tests/TESTING_GUIDE.md): 完全なテスト実行手順

**基本的なテスト実行:**
```powershell
# ユニットテスト
python tests/test_keyboard_monitor.py

# 安全な統合テスト（推奨）
python tests/safe_integration_test.py
```

### 依存関係

- `pynput`: キーボード入力の監視
- `colorama`: コンソール出力の色付け
- `pytest`: テスト実行（開発時）

## 今後の予定

### フェーズ1: コンソール版（現在開発中）

- [x] 仕様策定
- [x] ドキュメント作成
- [ ] 基本ロガー機能実装
- [ ] データ保存機能実装
- [ ] 統計分析機能実装
- [ ] CLI インターフェース実装

### フェーズ2: GUI版（将来計画）

- [ ] グラフィカルユーザーインターフェース
- [ ] リアルタイムグラフ表示
- [ ] 詳細設定画面
- [ ] 自動起動機能

## ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。

## 貢献

バグ報告や機能提案は、[Issues](https://github.com/your-username/keyboard-monitor/issues) でお気軽にお知らせください。

プルリクエストも歓迎しています！

## 免責事項

このソフトウェアは個人の学習・分析目的での使用を想定しています。他人のプライバシーを侵害する用途での使用は禁止されています。使用者の責任においてご利用ください。
