# キーボードモニター

> キーボード入力パターンを分析して、あなたのタイピング習慣を可視化するPythonツール

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Python](https://img.shields.io/badge/python-3.8+-green.svg)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey.svg)

## 概要

キーボードモニターは、あなたのキーボード使用パターンを記録・分析する軽量なPythonアプリケーションです。タイピングの癖を理解し、効率的なキーボードレイアウトの設計やタイピングスキルの向上に役立ちます。

### 主な機能

🔍 **リアルタイム監視**: すべてのキー入力をバックグラウンドで記録
📊 **基本統計分析**: キー使用頻度、総キーストローク数、使用パターン
⌨️ **モディファイア対応**: Ctrl/Shift/Alt/Win組み合わせの記録
� **シーケンス分析**: キーの前後関係と入力経路の可視化
�💾 **ローカル保存**: すべてのデータは安全にローカルに保存
🖥️ **CLI & GUI対応**: コマンドライン版とグラフィカル版の両方提供
🎨 **モダンインターフェース**: CustomTkinterによるシンプルなGUI
📈 **統計表示**: 基本的な使用統計の表示
🔧 **開発中機能**: 高度な分析機能とビジュアル表示を開発中

## インストール

### 前提条件

- Python 3.8以上
- Windows 10/11
- 管理者権限（初回実行時）

### セットアップ手順

1. **リポジトリのクローン**

   ```bash
   git clone https://github.com/your-username/keyboard-monitor.git
   cd keyboard-monitor
   ```

2. **依存関係のインストール**

   **CLI版のみ使用する場合:**
   ```bash
   pip install -r requirements.txt
   ```

   **GUI版も使用する場合:**
   ```bash
   pip install -r requirements-gui.txt
   ```

3. **初回設定**

   ```bash
   python src/keyboard_monitor.py --setup
   ```

## 使用方法

### 🎯 改善されたユーザーインターフェース

**v1.0での主要改善点:**
- ✅ **リアルタイム表示とコマンド入力の統合**: 入力中は表示更新が自動停止
- ✅ **スムーズなコマンド処理**: `q`、`t`などの短いコマンドも確実に動作
- ✅ **画面ちらつき防止**: カーソル位置制御による効率的な表示更新
- ✅ **直感的な操作感**: 自然で中断されないタイピング体験

### 基本的な使い方

#### 1. CLI版（コマンドライン）

```bash
python src/keyboard_monitor.py --cli
```

アプリケーションが起動すると、以下のような画面が表示されます：

```text
====================================
   キーボードモニター v2.0
====================================

状態: [停止中] | 最終記録: なし
コマンド: start, stop, stats, quit

> _
```

#### 2. GUI版（グラフィカルインターフェース）

**メインGUIアプリケーション:**
```bash
python gui/main_window.py
```

**モダンダッシュボード版:**
```bash
python gui/modern_dashboard.py
```

**シンプル版（WPM機能なし）:**
```bash
python gui/simple_gui_no_wpm.py
```

#### 3. 基本コマンド（CLI版）

| コマンド | 短縮形 | 説明 |
|----------|--------|------|
| `start` | `s` | キーボード記録開始 |
| `stop` | `t` | キーボード記録停止 |
| `stats` | `stat` | 統計情報表示 |
| `status` | `st` | 現在の状況確認 |
| `quit` | `q` | アプリケーション終了 |

#### 4. 統計情報の確認

記録を開始後、`stats`コマンドで詳細な分析結果を確認できます：

```text
> stats

====================================
   キーボード使用統計
====================================

記録期間: 2025-06-01 ～ 2025-06-10 (10日間)
総キーストローク: 1,041 回

使用頻度上位キー:
   1. S       :     95 回 (  9.1%)
   2. Enter   :     94 回 (  9.0%)
   3. Backspace:     82 回 (  7.9%)
   4. D       :     80 回 (  7.7%)
   5. T       :     70 回 (  6.7%)
   ...

改善提案:
  多様な文字パターンを使用しています。バリエーション豊かなタイピングです。
```

### コマンドライン操作

統計情報の確認は、アプリケーションを起動せずに直接実行することも可能です：

```bash
# 全期間の統計表示
python src/keyboard_monitor.py --stats

# 特定日の統計表示
python src/keyboard_monitor.py --stats 2025-06-01

# システム状況確認
python src/keyboard_monitor.py --status
```

### GUI機能

**メインGUIアプリケーション** (`gui/main_window.py`)の特徴：
- 📊 **統合ダッシュボード**: 統計、設定、情報を1つのウィンドウで管理
- 🎨 **ダーク/ライトテーマ**: お好みに合わせたテーマ切り替え
- 📈 **リアルタイム更新**: 記録中の統計情報をリアルタイム表示
- 🔗 **統合分析画面**: キーシーケンスと前後関係の詳細分析（開発予定）
- ⚙️ **詳細設定**: 保存間隔やテーマの詳細設定

**モダンダッシュボード** (`gui/modern_dashboard.py`)の特徴：
- 💳 **カードスタイルレイアウト**: 情報を見やすいカード形式で表示
- 📊 **基本統計表示**: テキストベースの統計情報表示
- 🔄 **自動更新**: 設定可能な間隔での自動統計更新
- 🎨 **モダンデザイン**: CustomTkinterによる洗練されたUI

**シンプル版** (`gui/simple_gui_no_wpm.py`)の特徴：
- 🎯 **軽量設計**: 最小限の機能に絞ったシンプルなインターフェース
- 📈 **基本統計**: キーストローク数と使用状況の表示

## 分析機能

### 基本統計

- **キー使用頻度**: 各キーの押下回数と割合
- **総キーストローク数**: 記録期間中の総入力数
- **記録期間**: データ収集の開始日と最終日
- **1日平均**: 日次平均のキーストローク数

### 高度な分析（開発中）

- **モディファイア組み合わせ**: Ctrl/Shift/Alt/Winとの組み合わせパターン
- **キーシーケンス分析**: 2文字・3文字の連続入力パターン
- **タイピング効率分析**: 使用パターンに基づく改善提案

### データ構造

記録されるデータは以下の形式でJSONファイルに保存されます：

```json
{
  "total_statistics": {
    "total_keystrokes": 25000,
    "first_record_date": "2025-06-01",
    "last_record_date": "2025-06-10"
  },
  "key_statistics": {
    "65": {
      "key_name": "A",
      "count": 850,
      "modifier_combinations": {
        "none": {"count": 750},
        "ctrl": {"count": 60},
        "shift": {"count": 40}
      }
    }
  }
}
```

## セキュリティとプライバシー

### データの扱い

- ✅ **完全ローカル**: すべてのデータはあなたのコンピューター内にのみ保存
- ✅ **ネットワーク送信なし**: インターネット接続は不要
- ✅ **個人利用限定**: 他人のコンピューターでの使用は禁止

### 注意事項

- パスワード入力時など、機密情報を扱う際は記録を一時停止することを推奨
- 共有コンピューターでの使用は避けてください
- データファイルは第三者がアクセスできない場所に保存されます

## トラブルシューティング

### よくある問題

#### 権限エラー

```text
エラー: キーボードアクセス権限が不足しています。
```

**解決方法**: 管理者権限でコマンドプロンプトを開き、再度実行してください。

#### ライブラリエラー

```text
エラー: 必要なライブラリが見つかりません。
```

**解決方法**:
```bash
pip install -r requirements.txt
```

#### データファイルエラー

```text
エラー: データファイルにアクセスできません。
```

**解決方法**: `data/`ディレクトリの権限を確認し、必要に応じて再作成してください。

### ログファイル

問題の詳細は以下のログファイルで確認できます：

- `logs/keyboard_monitor.log`: 一般的な動作ログ
- `logs/error.log`: エラー詳細ログ

## 開発情報

### プロジェクト構成

```text
keyboard-monitor/
├── src/                          # CLI版ソースコード
│   ├── keyboard_monitor.py       # メインアプリケーション
│   ├── logger.py                # キーロガー
│   ├── statistics.py            # 統計分析
│   ├── config.py                # 設定管理
│   ├── analyzer.py              # データ分析
│   ├── data_store.py            # データストレージ
│   └── save_manager.py          # 保存管理
├── gui/                         # GUI版ソースコード
│   ├── main_window.py           # メインGUIアプリケーション
│   ├── modern_dashboard.py      # モダンダッシュボード
│   ├── simple_gui_no_wpm.py     # シンプル版GUI
│   ├── test_dashboard_fixed.py  # テスト用ダッシュボード
│   ├── components/              # GUIコンポーネント
│   │   ├── dashboard.py         # ダッシュボード（完全版）
│   │   ├── dashboard_no_wpm.py  # ダッシュボード（簡易版）
│   │   └── settings_panel.py    # 設定パネル
│   └── styles/                  # テーマとスタイル
│       └── themes.py            # テーマ定義
├── data/                        # データファイル
├── tests/                       # テストファイル
│   ├── data_save_feature_test.py # データ保存テスト
│   └── gui_timer_test.py        # GUIタイマーテスト
├── doc/                         # ドキュメント
│   ├── SPECIFICATIONS.md        # 技術仕様書
│   ├── ARCHITECTURE.md          # アーキテクチャ設計
│   ├── CLI_INTERFACE.md         # CLI仕様
│   ├── GUI_REQUIREMENTS.md      # GUI要件定義
│   └── GUI_DEVELOPMENT_PLAN.md  # GUI開発計画
├── requirements.txt             # CLI版依存関係
├── requirements-gui.txt         # GUI版依存関係
└── README.md                   # このファイル
```

### 技術仕様

詳細な技術情報は以下のドキュメントを参照してください：

- 📋 [技術仕様書](doc/SPECIFICATIONS.md): データ構造とAPIの詳細
- 🏗️ [アーキテクチャ設計](doc/ARCHITECTURE.md): システム設計とコンポーネント構成
- 💻 [CLI仕様](doc/CLI_INTERFACE.md): コマンドラインインターフェースの詳細

### テスト

包括的なテストスイートが用意されています：

- 🧪 [テスト実行ガイド](tests/README.md): クイックスタートと概要
- 📖 [詳細テストガイド](tests/TESTING_GUIDE.md): 完全なテスト実行手順

**基本的なテスト実行:**
```powershell
# ユニットテスト
python tests/test_keyboard_monitor.py

# 安全な統合テスト（推奨）
python tests/safe_integration_test.py
```

### 依存関係

**CLI版:**
- `pynput`: キーボード入力の監視
- `colorama`: コンソール出力の色付け
- `pytest`: テスト実行（開発時）

**GUI版（追加）:**
- `customtkinter`: モダンなGUIフレームワーク
- `matplotlib`: グラフ表示
- `pystray`: システムトレイ統合
- `Pillow`: 画像処理

## 今後の予定

### フェーズ1: コンソール版（✅ 完成）

- [x] 仕様策定
- [x] ドキュメント作成
- [x] 基本ロガー機能実装
- [x] データ保存機能実装
- [x] 統計分析機能実装
- [x] CLI インターフェース実装

### フェーズ2: GUI版（🔧 部分完成）

#### Phase 2.1: 基本GUIフレームワーク
- [x] CustomTkinter セットアップ
- [x] メインウィンドウの設計・実装
- [x] 基本レイアウト（ダッシュボード、統計、設定）
- [x] テーマシステム（Dark/Light）

#### Phase 2.2: コア機能GUI化
- [x] キーボード記録の開始/停止UI
- [x] リアルタイム統計表示パネル
- [x] 基本統計情報の可視化
- [x] システムトレイ統合

#### Phase 2.3: 高度な視覚化（未実装）
- [ ] リアルタイムグラフ表示
  - [ ] キーストローク頻度グラフ
  - [ ] タイピング効率チャート
  - [ ] ヒートマップ表示
- [ ] インタラクティブな統計ビュー
- [ ] データエクスポート機能

#### Phase 2.4: 詳細設定とカスタマイズ
- [ ] 詳細設定GUI
- [ ] カスタムアラート・通知
- [ ] 自動起動機能
- [ ] プロファイル管理

#### Phase 2.5: 仕上げと最適化
- [ ] パフォーマンス最適化
- [ ] ユーザビリティテスト
- [ ] アクセシビリティ対応
- [ ] プロジェクトクリーンアップ

### フェーズ3: 拡張機能（今後の計画）

#### Phase 3.1: パッケージ化
- [ ] Windows実行ファイル作成
- [ ] インストーラー作成
- [ ] 自動更新機能

#### Phase 3.2: 高度な分析機能
- [ ] 機械学習による入力パターン予測
- [ ] 疲労度分析
- [ ] 生産性レポート

#### Phase 3.3: クラウド連携（オプション）
- [ ] データバックアップ機能
- [ ] 複数デバイス間の同期
- [ ] チーム分析機能

## ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。

## 貢献

バグ報告や機能提案は、[Issues](https://github.com/your-username/keyboard-monitor/issues) でお気軽にお知らせください。

プルリクエストも歓迎しています！

## 免責事項

このソフトウェアは個人の学習・分析目的での使用を想定しています。他人のプライバシーを侵害する用途での使用は禁止されています。使用者の責任においてご利用ください。
